# CopyRevitSchedules

## Основные технологии
1. .NET Framework 4.8
2. LINQ
3. Revit API 2020
4. WPF
5. WinForms

## Назначение и логика работы
Плагин предназначен для пакетного копирования спецификаций из текущего проекта (откуда выполняется запуск) в список моделей, который подается в плагин в виде .txt файла с полными абсолютными путями к обрабатываемым моделям. Для моделей раздела КР после копирования плагин также меняет значение фильтра в зависимости от имени обрабатываемой модели (значение поля "_КЖ2.1" в имени модели). Имена копируемых спецификаций зашиты в коде.
Результаты выполнения программы пишется в отчет, который отображается в окне после обработки всех файлов, где по каждому обрабатываемому файлу указавыется:
 - Полный путь до него
 - Результат работы
 - Время обработки файла 
 - Общее время обработки всех файлов
  
## Установка и запуск
Скопировать релиз, распаковать и положить содержимое папки CopySchedules в папку с плагинами для подгрузки их в Revit: **C:\Users\%username%\AppData\Roaming\Autodesk\Revit\Addins\2020**
При запуске Revit в появившемся окне выбрать "Всегда загружать" или "Загрузить один раз".

## Интерфейс
![Интерфейс](https://github.com/ipbtech/CopyRevitSchedules_Test/assets/110702050/1890c64c-5211-4274-b8ed-9d414ffc31c5)

1. Загрузка .txt файла с полными путями к обрабатываемым моделям (открывается диалоговое окно с директорией по умолчанию "Рабочий стол")
2. Вспомогательное окно, в котором отображаются имена моделей для обрбаботки после загрузки .txt файла
3. Выборка спецификаций АР из текущего проекта (при отжатии галочки выборка очищается)
4. Выборка спецификаций КР из текущего проекта (при отжатии галочки выборка очищается)
5. Кнопка запуска программы

## Требования для корреткной работы
Для запуска плагина на вход должен быть подан .txt файл со списком путей к обрабатываемым моделям, а также выбраны либо спецификации АР, либо спецификации КР, либо 2 варианта. При попытке холостого запуска, либо при отсутствии требуемых спецификаций в проекте, будет отображено уведомляющее окно.
